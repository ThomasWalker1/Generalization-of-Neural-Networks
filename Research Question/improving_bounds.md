# McAllester's Bound 2013

**Theorem** Simultaneously for all $\mathbf{w}\in\mathcal{W}$ and $\delta\in(0,1)$ the following holds, $$\mathbb{P}_{S\sim\mathcal{D}^m}\left(R(\mathbf{w})\leq\inf_{\lambda>\frac{1}{2}}\frac{1}{1-\frac{1}{2\lambda}}\left(\hat{R}(\mathbf{w})+\frac{\lambda C}{m}\left(\log\left(\frac{1}{\pi(\mathbf{w})}\right)+\log\left(\frac{1}{\delta}\right)\right)\right)\right)\geq1-\delta.$$

Recall, that in the proof of this theorem we worked with the quantity $$\epsilon(\mathbf{w})=\sqrt{\frac{2R(\mathbf{w})\left(\log\left(\frac{1}{\pi(\mathbf{w})}\right)+\log\left(\frac{1}{\delta}\right)\right)}{m}}$$ for $\mathbf{w}\in\mathcal{W}$ and considered loss functions bounded by $C=1$. We proceed by considering $$\mathbb{P}_{S\sim\mathcal{D}^m}\left(\hat{R}(\mathbf{w})\leq R(\mathbf{w})-\epsilon(\mathbf{w})\right)=\sum_{k=0}^m\mathbb{P}_{S\sim\mathcal{D}^k}\left(\hat{R}(\mathbf{w})\leq R(\mathbf{w})-\epsilon(\mathbf{w})\Big\vert z_{[k]}\notin\Delta,z_{[[k]]_m}\in\Delta\right)p_{\Delta}^{m-k}(1-p_{\Delta})^k.$$ Accounting for $l_{z_i}=0$ for $z_i=0$ we can allow the empirical error to increase by a factor of $\frac{m}{k}$ to give $$\begin{align*}\mathbb{P}_{S\sim\mathcal{D}^m}\left(\hat{R}(\mathbf{w})\leq R(\mathbf{w})-\epsilon(\mathbf{w})\right)&=\delta\mathbb{I}\left(\epsilon(\mathbf{w})\leq R(\mathbf{w})\right)p_{\Delta}^m+\sum_{k=1}^m\mathbb{P}_{S\sim\mathcal{D}^k}\left(\frac{m}{k}\hat{R}_k(\mathbf{w})\leq R(\mathbf{w})-\epsilon(\mathbf{w})\right)p_{\Delta}^{m-k}(1-p_{\Delta})^k\\&=\delta\mathbb{I}\left(\epsilon(\mathbf{w})\leq R(\mathbf{w})\right)p_{\Delta}^m+\sum_{k=1}^m\mathbb{P}_{S\sim\mathcal{D}^m}\left(\hat{R}_k(\mathbf{w})\leq R(\mathbf{w})-\left(\frac{m-k}{m}R(\mathbf{w})+\epsilon(\mathbf{w})\right)\right)p_{\Delta}^{m-k}(1-p_{\Delta})^k.\end{align*}$$ Let $$\tilde{\epsilon}(\mathbf{w})=\frac{m-k}{m}R(\mathbf{w})+\epsilon(\mathbf{w})$$ and then apply Corollary 2.2.2 to each component of the sum to deduce that $$\mathbb{P}_{S\sim\mathcal{D}^m}\left(\hat{R}(\mathbf{w})\leq R(\mathbf{w})-\epsilon(\mathbf{w})\right)\leq\delta p{\Delta}^m+\sum_{k=1}^m\exp\left(-\frac{k\tilde{\epsilon}(\mathbf{w})^2}{2R(\mathbf{w})}\right)p_{\Delta}^{m-k}(1-p_{\Delta})^k.$$