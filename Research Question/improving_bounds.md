# McAllester's Bound 2013

Suppose that we have a bias on the countable parameter space $\mathcal{W}$ denoted by $\pi$. We will now derive a bound inspired by the proof of the theorem stated below.

**Theorem** Simultaneously for all $\mathbf{w}\in\mathcal{W}$ and $\delta\in(0,1)$ the following holds, $$\mathbb{P}_{S\sim\mathcal{D}^m}\left(R(\mathbf{w})\leq\inf_{\lambda>\frac{1}{2}}\frac{1}{1-\frac{1}{2\lambda}}\left(\hat{R}(\mathbf{w})+\frac{\lambda C}{m}\left(\log\left(\frac{1}{\pi(\mathbf{w})}\right)+\log\left(\frac{1}{\delta}\right)\right)\right)\right)\geq1-\delta.$$

Consider $$\mathbb{P}_{S\sim\mathcal{D}^m}\left(\hat{R}(\mathbf{w})\leq R(\mathbf{w})-\epsilon(\mathbf{w})\right)=\sum_{k=0}^m\binom{m}{k}\mathbb{P}_{S\sim\mathcal{D}^k}\left(\hat{R}(\mathbf{w})\leq R(\mathbf{w})-\epsilon(\mathbf{w})\Big\vert z_{[k]}\notin\Delta,z_{[[k]]_m}\in\Delta\right)p_{\Delta}^{m-k}(1-p_{\Delta})^k.$$ Accounting for $l_{z_i}=0$ for $z_i=0$ we can allow the empirical error on the sample of size $k$ to increase by a factor of $\frac{m}{k}$ to give $$\begin{align*}\mathbb{P}_{S\sim\mathcal{D}^m}\left(\hat{R}(\mathbf{w})\leq R(\mathbf{w})-\epsilon(\mathbf{w})\right)&=\mathbb{I}\left(\epsilon(\mathbf{w})\leq R(\mathbf{w})\right)p_{\Delta}^m+\sum_{k=1}^m\binom{m}{k}\mathbb{P}_{S\sim\mathcal{D}^k}\left(\frac{m}{k}\hat{R}_k(\mathbf{w})\leq R(\mathbf{w})-\epsilon(\mathbf{w})\right)p_{\Delta}^{m-k}(1-p_{\Delta})^k\\&=\mathbb{I}\left(\epsilon(\mathbf{w})\leq R(\mathbf{w})\right)p_{\Delta}^m+\sum_{k=1}^m\binom{m}{k}\mathbb{P}_{S\sim\mathcal{D}^m}\left(\hat{R}_k(\mathbf{w})\leq R(\mathbf{w})-\left(\frac{m-k}{m}R(\mathbf{w})+\frac{k}{m}\epsilon(\mathbf{w})\right)\right)p_{\Delta}^{m-k}(1-p_{\Delta})^k\\&\leq\mathbb{I}\left(\epsilon(\mathbf{w})\leq R(\mathbf{w})\right)p_{\Delta}^m+\sum_{k=1}^m\binom{m}{k}\mathbb{P}_{S\sim\mathcal{D}^m}\left(\hat{R}_k(\mathbf{w})\leq R(\mathbf{w})-\frac{1}{m}\left(R(\mathbf{w})+\epsilon(\mathbf{w})\right)\right)p_{\Delta}^{m-k}(1-p_{\Delta})^k.\end{align*}$$ Using Corollary 2.2.2 we can deduce that $$\begin{align*}\mathbb{P}_{S\sim\mathcal{D}^m}\left(\hat{R}(\mathbf{w})\leq R(\mathbf{w})-\epsilon(\mathbf{w})\right)&\leq\sum_{k=0}^m\binom{m}{k}\exp\left(-\frac{kR(\mathbf{w})\left(\frac{k}{m}+\frac{k\epsilon(\mathbf{w})}{R(\mathbf{w})}\right)^2}{2}\right)p_{\Delta}^{m-k}(1-p_{\Delta})^k\quad(\star)\\&\leq\sum_{k=1}^m\binom{m}{k}\exp\left(-\frac{R(\mathbf{w})\left(\frac{1}{m}+\frac{\epsilon(\mathbf{w})}{R(\mathbf{w})}\right)^2}{2}\right)p_{\Delta}^{m-k}(1-p_{\Delta})^k\\&=\exp\left(\frac{-R(\mathbf{w})\left(\frac{1}{m}+\frac{\epsilon(\mathbf{w})}{R(\mathbf{w})}\right)^2}{2}\right)(1-p_{\Delta}^m).\end{align*}$$ where the last inequality holds under the assumption that $\epsilon(\mathbf{w})\leq R(\mathbf{w})$ which we can ensure by an eventual condition on $\delta$. To determine the correct expression for $\epsilon(\mathbf{w})$ we solve $$\exp\left(\frac{-R(\mathbf{w})\left(\frac{1}{m}+\frac{\epsilon(\mathbf{w})}{R(\mathbf{w})}\right)^2}{2}\right)(1-p_{\Delta}^m)=\pi(\mathbf{w})\delta$$ to see that $$\epsilon(\mathbf{w})=R(\mathbf{w})\left(\sqrt{\frac{\log\left(\frac{1-p_{\Delta}^m}{\pi(\mathbf{w})\delta}\right)}{2R(\mathbf{w})}}-\frac{1}{m}\right).$$ With the condition that $\delta\leq\frac{1-p_{\Delta}^m}{\sup_{\mathbf{w}\in\mathcal{W}}\pi(\mathbf{w})}$ to ensure that the square root is well-defined. With this expression for $\epsilon(\mathbf{w})$ we can determine the condition on $\delta$ to guarantee that $\epsilon(\mathbf{w})\leq R(\mathbf{w})$. As $R(\mathbf{w})$ is unknown we can only guarantee this is satisfied for $\delta\geq\frac{1-p_{\Delta}^m}{\sup_{\mathbf{w}\in\mathcal{W}}\pi(\mathbf{w})}$ which when combined with out previous condition implies that $\delta=\frac{1-p_{\Delta}^m}{\sup_{\mathbf{w}\in\mathcal{W}}\pi(\mathbf{w})}$. Therefore, applying a union bound we deduce that for all $\mathbf{w}\in\mathcal{W}$ $$\mathbb{P}_{S\sim\mathcal{D}^m}\left(\hat{R}(\mathbf{w})\leq R(\mathbf{w})-\frac{R(\mathbf{w})}{m}\right)\leq\delta$$ which implies that $$\mathbb{P}_{S\sim\mathcal{D}^m}\left(R(\mathbf{w})\leq\frac{m}{m-1}\hat{R}(\mathbf{w})\right)\geq1-\frac{1-p_{\Delta}^m}{\sup_{\mathbf{w}\in\mathcal{W}}\pi(\mathbf{w})}.$$ An alternative approach proceeds from $(\star)$ where we note the relationship of the expression to the moment generating function of a binomial random variable $K$ with parameter $1-p_{\Delta}$. Observe that, $$\begin{align*}\sum_{k=0}^m\binom{m}{k}\exp\left(-\frac{kR(\mathbf{w})\left(\frac{k}{m}+\frac{k\epsilon(\mathbf{w})}{R(\mathbf{w})}\right)^2}{2}\right)p_{\Delta}^{m-k}(1-p_{\Delta})^k&\leq\sum_{k=0}^m\binom{m}{k}\exp\left(-\frac{kR(\mathbf{w})\left(\frac{1}{m}+\frac{\epsilon(\mathbf{w})}{R(\mathbf{w})}\right)^2}{2}\right)p_{\Delta}^{m-k}(1-p_{\Delta})^k\\&=\mathbb{E}\left(\exp\left(-\frac{KR(\mathbf{w})\left(\frac{1}{m}+\frac{\epsilon(\mathbf{w})}{R(\mathbf{w})}\right)^2}{2}\right)\right)\\&=M_K\left(-\frac{R(\mathbf{w})\left(\frac{1}{m}+\frac{\epsilon(\mathbf{w})}{R(\mathbf{w})}\right)^2}{2}\right)\\&\left(p_{\Delta}+(1-p_{\Delta})\exp\left(-\frac{KR(\mathbf{w})\left(\frac{1}{m}+\frac{\epsilon(\mathbf{w})}{R(\mathbf{w})}\right)^2}{2}\right)\right)^m.\end{align*}$$ We can solve the equation $$\left(p_{\Delta}+(1-p_{\Delta})\exp\left(-\frac{KR(\mathbf{w})\left(\frac{1}{m}+\frac{\epsilon(\mathbf{w})}{R(\mathbf{w})}\right)^2}{2}\right)\right)^m=\delta\pi(\mathbf{w})$$ to get that $$\epsilon(\mathbf{w})=R(\mathbf{w})\left(\sqrt{-\frac{2\log\left(\frac{(\pi(\mathbf{w})\delta)^\frac{1}{m}-p_{\Delta}}{1-p_{\Delta}}\right)}{R(\mathbf{w})}}-\frac{1}{m}\right)$$ with the condition that $$\delta\in\left(\frac{p_{\Delta}^m}{\sup_{\mathbf{w}\in\mathcal{W}}},\frac{1}{\sup_{\mathbf{w}\in\mathcal{W}}}\right]$$ to ensure that the square root is well-defined. Applying the union bound and considering the complement we conclude that $$\mathbb{P}_{S\sim\mathcal{D}^m}\left(R(\mathbf{w})\leq\hat{R}(\mathbf{w})+\epsilon(\mathbf{w})\right)\geq1-\delta.$$